<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/css/churchlandstyle.css">
    <script src="https://wzrd.in/standalone/formdata-polyfill"></script>
    <script src="https://wzrd.in/standalone/promise-polyfill@latest"></script>
    <script src="https://wzrd.in/standalone/whatwg-fetch@latest"></script>
  </head>
  <body>
    <div class="topbox"></div>
    <div class="botbox"></div>
    <div class="midbox">
    <h2 class="sc">Know of a church developing its land? Tell us about it!</h2>
      <p>Sometimes churches have land, and sometimes churches choose to start using that land differently.</p>
      <p>This is a project to learn more about how churches develop their land and to create resources for churches that might develop in the future. Help us create these resources by sharing any examples of church land development you know of.</p>
      <p class="disclaimer">If you have multiple examples, please separate answers by semi-colons, fill out the form multiple times, or write to us by <a href="mailto:notkin@gsd.harvard.edu">email</a>.</p>
      <form name="submit-to-google-sheet">
        <div class="providing">
         <h2 class="sc">What's the church called?</h2>
          <input name="church_name" class="providing" type="text" placeholder="Name of the church">
          <h2 class="sc">Where is it?</h2>
          <input class="nosubmit providing" type="text" name="church_city" placeholder="City, State">
        </div>
        <div class="providing wanting">
          <h2 class="sc">Who are you? <span="wanting">(Optional)</span></h2>
          <input class="nosubmit" type="text" name="user_name" placeholder="Your name">
          <input class="nosubmit wanting" type="email" name="user_email" placeholder="Your email">
        </div>
        <div class="providing">
        <h2 class="sc">Who else could I talk to about it? <span class="wanting">(Optional)</span></h2>
        <input class="nosubmit" type="text" name="contact_name" placeholder="Contact name">
        <input class="nosubmit" type="text" name="contact_contact" placeholder="Contact email or phone">
        <h2 class="sc">What do you know about it? (optional)</h2>
        <textarea id="church-description" name="description" placeholder="What do you find interesting about the project? Who was involved? What was built? What were the goals? etc." rows=4></textarea>
        </div>
        <label><input type="checkbox" id="wanting" name="wanting"><span>I'm interested in receiving the materials developed through this project. (Please be sure to include your email address above.)</span></label>
        <button type="submit">Send</button>
      </form>
          <!-- SCRIPT TO TOGGLE REQUIRED FOR FIELDS BASED ON CHECKBOXES, BUT CURRENTLY NOT WORKING<script type="application/javascript">
      var providingBox = document.querySelector('input[name="providing"]');
      var providingInput = document.querySelector('input[class="providing"]');

      function providingToggleRequired() {

          if (providingInput.hasAttribute('required') !== true) {
              providingInput.setAttribute('required','required');
          }

          else {
              providingInput.removeAttribute('required');  
          }
      }
      
      providingBox.addEventListener('change',providingToggleRequired,false);

      var wantingBox = document.querySelector('input[name="wanting"]');
      var wantingInput = document.querySelector('input[class="wanting"]');

      function wantingToggleRequired() {

          if (wantingInput.hasAttribute('required') !== true) {
              wantingInput.setAttribute('required','required');
          }

          else {
              wantingInput.removeAttribute('required');  
          }
      }
      
      wantingBox.addEventListener('change',wantingToggleRequired,false);

    </script> -->
    <script type="application/javascript">
      const scriptURL = 'https://script.google.com/macros/s/AKfycbyr6HydOtGeP_Db3Ofss-ZGKBWZ1dDcyN7Gjx7F0fBquf93HkY/exec'
      const form = document.forms['submit-to-google-sheet']

      form.addEventListener('submit', e => {
        e.preventDefault()
        fetch(scriptURL, { method: 'POST', body: new FormData(form)})
          .then(response => { console.log('Success!', response); window.location.href="https://bennotkin.github.io/church-land/form-submitted.html";} )
          .catch(error => { console.error('Error!', error.message)} )
      })
    </script>
      <p class="disclaimer">If you are not soon directed to a new page after submitting, please send your response via <a href="mailto:notking@gsd.harvard.edu">email</a>.</p>
      <p class="disclaimer">Interested in learning more about this project? Write to <a href="mailto:notkin@gsd.harvard.edu">Ben Notkin</a>.</p>
      <p class="disclaimer">Research is funded by Harvard University.</p>
    </div>
  </body>
